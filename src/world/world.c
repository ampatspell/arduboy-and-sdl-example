#include "world.h"
#include "interval.h"

struct AMWorld {
  AMPlatformRef platform;
};

struct AMWorld __world;

AMWorldRef AMWorldCreate(AMPlatformRef platform) {
  AMWorldRef world = &__world;
  world->platform = platform;
  return world;  
}

const unsigned char sprite_1[] PROGMEM = {
  12, 16,
  0xc0, 0xc0, 0x60, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0x60, 0xe0, 0xc0, 0xc0, 0x1f, 0x1f, 0x30, 0x3f, 0xef, 0xff, 0xaf, 0xff, 0x8f, 0xff, 0xef, 0xff, 0x2e, 0x3f, 0xef, 0xff, 0x8e, 0xff, 0xaf, 0xff, 0xf0, 0xff, 0x1f, 0x1f,
  0xc0, 0xc0, 0x60, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0x60, 0xe0, 0xc0, 0xc0, 0x1f, 0x1f, 0x30, 0x3f, 0xef, 0xff, 0xaf, 0xff, 0x8f, 0xff, 0xef, 0xff, 0xee, 0xff, 0xaf, 0xff, 0x8e, 0xff, 0xef, 0xff, 0x10, 0x1f, 0x1f, 0x1f,
  0xc0, 0xc0, 0x60, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0x60, 0xe0, 0xc0, 0xc0, 0x1f, 0x1f, 0x30, 0x3f, 0xef, 0xff, 0xaf, 0xff, 0x8f, 0xff, 0xef, 0xff, 0xee, 0xff, 0xaf, 0xff, 0x8f, 0xff, 0xef, 0xff, 0x10, 0x1f, 0x1f, 0x1f,
  0xc0, 0xc0, 0x60, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0xa0, 0xe0, 0x60, 0xe0, 0xc0, 0xc0, 0x1f, 0x1f, 0x30, 0x3f, 0xef, 0xff, 0xaf, 0xff, 0x8f, 0xff, 0xef, 0xff, 0x2e, 0x3f, 0xef, 0xff, 0x8f, 0xff, 0xaf, 0xff, 0xf0, 0xff, 0x1f, 0x1f
};

const unsigned char sprite_2[] PROGMEM = {
  23, 16,
  0x00, 0xf8, 0xf8, 0xfc, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xf8, 0xfc, 0x00, 0xf8, 0x00, 0x03, 0x03, 0x07, 0x07, 0xff, 0x3f, 0x7f, 0x1f, 0x3f, 0x0f, 0x1f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x03, 0x07, 0x00, 0x03,
  0x00, 0xf8, 0xf8, 0xfc, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0x7c, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xf8, 0xfc, 0x00, 0xf8, 0x00, 0x03, 0x03, 0x07, 0x07, 0xff, 0x3e, 0x7f, 0x1e, 0x3f, 0x0f, 0x1f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x03, 0x07, 0x00, 0x03,
  0x00, 0xf8, 0xf8, 0xfc, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0x7c, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xac, 0xfe, 0xec, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xf8, 0xfc, 0x00, 0xf8, 0x00, 0x03, 0x03, 0x07, 0x07, 0xff, 0x3e, 0x7f, 0x1e, 0x3f, 0x0f, 0x1f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x03, 0x07, 0x00, 0x03,
  0x00, 0xf8, 0xf8, 0xfc, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0x7c, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xac, 0xfe, 0xec, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xf8, 0xfc, 0x00, 0xf8, 0x00, 0x03, 0x03, 0x07, 0x07, 0xff, 0x3e, 0x7f, 0x1e, 0x3f, 0x0f, 0x1f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x07, 0x0f, 0x03, 0x07, 0x00, 0x03,
  0x00, 0xf8, 0xf8, 0xfc, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0x7c, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xac, 0xfe, 0xec, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0x0c, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xfc, 0xfe, 0xf8, 0xfc, 0x00, 0xf8, 0x00, 0x03, 0x03, 0x07, 0x07, 0xff, 0x3e, 0x7f, 0x1e, 0x3f, 0x0f, 0x1f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x06, 0x0f, 0x07, 0x0f, 0x03, 0x07, 0x00, 0x03
};

uint8_t s1 = 0;
uint8_t s2 = 0;

AMInterval interval;

void AMWorldSetup(AMWorldRef world) {
  AMIntervalInit(&interval, 300);
}

void AMWorldTick(AMWorldRef world) {
  AMPlatformDrawSpritePlusMask(57, 38, sprite_2, s2);
  AMPlatformDrawSpritePlusMask(50, 64-16, sprite_1, s1);
  
  if(AMIntervalTick(&interval)) {
    s2++;
    if(s2 > 4) {
      s2=0;
    }
  }
  
}
